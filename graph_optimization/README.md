# Graph-Based Sensor Fusion
In this project, we loosely couple the wheel encoder information into the system. The sensor fusion is off-line and is used to process the ORB-SLAM3 generates estimated poses. The first 726 estimated poses are used to build the value instances in the factor graph, and the corresponding odometry information is used to construct the factors. The first pose generated by ORB-SLAM3 is at the origin. However, the ground-truth pose of the corresponding timestamp is not at the origin. Therefore, we first use the corresponding ground-truth pose to generate the transformation matrix. Then, we transform the estimated poses to make the estimated poses and the ground-truth poses in the same reference coordinate. Afterward, we use a nonlinear factor graph as our graph and use the ISAM2 solver to optimize the trajectory incrementally.

## Implementation
### GTSAM Library
In this project, we solve the problem using the GTSAM library. 
A detailed tutorial is on [GTSAM website](https://gtsam.org/tutorials/intro.html).
The instruction of building the library is on [GTSAM github page](https://github.com/borglab/gtsam).

### Data 
To implement the `Graph Optimization.m`, four data files are needed:
1. `groundtruth_2012-03-17.csv` contains all the ground truth data of the 2012-03-17 Session in the NCLT dataset. We provide it here or you can download it from the [NCLT's download page](http://robots.engin.umich.edu/nclt/ground_truth/groundtruth_2012-03-17.csv)
2. `0407_CameraTrajectory.txt` contains estimated poses from the implementation of the ORB-SLAM3. We used these poses to build the value instances in the factor graph.
3. `0407_odometry_mu.csv` contains odometry mean values corresponding to the first 726 timestamp estimated poses. We used it to construct the factors.
4. `0407_odometry_cov.csv` contains odometry covariance values corresponding to the first 726 timestamp estimated poses. We used it to construct the factors.

### Optimization
Execute the `Graph Optimization.m`, there will be a figure showing the trajectories and the evaluation metrics mentioned in the report.
